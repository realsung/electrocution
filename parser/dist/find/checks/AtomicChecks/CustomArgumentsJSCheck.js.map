{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/CustomArgumentsJSCheck.js"],"names":["sourceTypes","severity","confidence","CustomArgumentsJSCheck","constructor","id","description","type","JAVASCRIPT","shortenedURL","dangerousArguments","match","astNode","astHelper","methods","callee","name","includes","property","arguments","length","StringLiteral","value","res","some","arg","line","loc","start","column","MEDIUM","TENTATIVE","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,sBAAN,CAA6B;AAC1CC,gBAAc;AACZ,SAAKC,EAAL,GAAU,2BAAV;AACA,SAAKC,WAAL,GAAoB,iDAApB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACA,SAAKC,kBAAL,GAA0B,CACxB,2BADwB,EAExB,qCAFwB,EAGxB,iCAHwB,EAIxB,sBAJwB,EAKxB,YALwB,EAMxB,qBANwB,EAOxB,uBAPwB,EAQxB,mCARwB,EASxB,UATwB,EAUxB,8BAVwB,EAWxB,sBAXwB,EAYxB,gCAZwB,EAaxB,wBAbwB,EAcxB,mBAdwB,EAexB,kBAfwB,EAgBxB,4BAhBwB,EAiBxB,2BAjBwB,EAkBxB,qBAlBwB,EAmBxB,4BAnBwB,EAoBxB,mBApBwB,EAqBxB,0BArBwB,EAsBxB,uBAtBwB,EAuBxB,SAvBwB,EAwBxB,aAxBwB,EAyBxB,0BAzBwB,EA0BxB,8BA1BwB,EA2BxB,cA3BwB,EA4BxB,kCA5BwB,EA6BxB,iBA7BwB,EA8BxB,sBA9BwB,EA+BxB,YA/BwB,EAgCxB,6BAhCwB,EAiCxB,0CAjCwB,CAA1B;AAmCD;;AAEDC,QAAMC,OAAN,EAAeC,SAAf,EAA0B;AACxB,UAAMC,UAAU,CAAC,gBAAD,EAAmB,cAAnB,CAAhB;;AAEA,QAAIF,QAAQL,IAAR,KAAiB,gBAArB,EAAuC,OAAO,IAAP;AACvC,QAAKK,QAAQG,MAAR,CAAeC,IAAf,IAAuBF,QAAQG,QAAR,CAAiBL,QAAQG,MAAR,CAAeC,IAAhC,CAAxB,IAAmEJ,QAAQG,MAAR,CAAeG,QAAf,IAA2BJ,QAAQG,QAAR,CAAiBL,QAAQG,MAAR,CAAeG,QAAf,CAAwBF,IAAzC,CAAlG,EAAmJ;AACjJ,UAAIJ,QAAQO,SAAR,IAAqBP,QAAQO,SAAR,CAAkBC,MAAlB,GAA2B,CAAhD,IAAqDR,QAAQO,SAAR,CAAkB,CAAlB,EAAqBZ,IAArB,KAA8BM,UAAUQ,aAA7F,IAA8GT,QAAQO,SAAR,CAAkB,CAAlB,EAAqBG,KAAvI,EAA8I;AAC5I,YAAIC,MAAM,KAAKb,kBAAL,CAAwBc,IAAxB,CAA6B,UAASC,GAAT,EAAc;AACnD,iBAAOb,QAAQO,SAAR,CAAkB,CAAlB,EAAqBG,KAArB,CAA2BL,QAA3B,CAAoCQ,GAApC,CAAP;AACD,SAFS,CAAV;;AAIA,YAAIF,GAAJ,EACE,OAAO,CAAC,EAAEG,MAAMd,QAAQe,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQjB,QAAQe,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkExB,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAAS6B,MAAlK,EAA0K5B,YAAYA,WAAW6B,SAAjM,EAA4MC,cAAc,KAA1N,EAAD,CAAP;AACH;AACF;AACF;AAzDyC","file":"CustomArgumentsJSCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class CustomArgumentsJSCheck {\n  constructor() {\n    this.id = 'CUSTOM_ARGUMENTS_JS_CHECK';\n    this.description = `Review the use of custom command line arguments`;\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = \"https://git.io/Jeu1h\";\n    this.dangerousArguments = [\n      \"ignore-certificate-errors\",\n      \"ignore-certificate-errors-spki-list\",\n      \"ignore-urlfetcher-cert-requests\",\n      \"disable-web-security\",\n      \"host-rules\",\n      \"host-resolver-rules\",\n      \"auth-server-whitelist\",\n      \"auth-negotiate-delegate-whitelist\",\n      \"js-flags\",\n      \"allow-file-access-from-files\",\n      \"allow-no-sandbox-job\",\n      \"allow-running-insecure-content\",\n      \"cipher-suite-blacklist\",\n      \"debug-packed-apps\",\n      \"disable-features\",\n      \"disable-kill-after-bad-ipc\",\n      \"disable-webrtc-encryption\",\n      \"disable-xss-auditor\",\n      \"enable-local-file-accesses\",\n      \"enable-nacl-debug\",\n      \"remote-debugging-address\",\n      \"remote-debugging-port\",\n      \"inspect\",\n      \"inspect-brk\",\n      \"explicitly-allowed-ports\",\n      \"expose-internals-for-testing\",\n      \"gpu-launcher\",\n      \"nacl-dangerous-no-sandbox-nonsfi\",\n      \"nacl-gdb-script\",\n      \"net-log-capture-mode\",\n      \"no-sandbox\",\n      \"reduce-security-for-testing\",\n      \"unsafely-treat-insecure-origin-as-secure\"\n    ];\n  }\n\n  match(astNode, astHelper) {\n    const methods = ['appendArgument', 'appendSwitch'];\n\n    if (astNode.type !== 'CallExpression') return null;\n    if ((astNode.callee.name && methods.includes(astNode.callee.name)) || (astNode.callee.property && methods.includes(astNode.callee.property.name))) {\n      if (astNode.arguments && astNode.arguments.length > 0 && astNode.arguments[0].type === astHelper.StringLiteral && astNode.arguments[0].value) {\n        var res = this.dangerousArguments.some(function(arg) {\n          return astNode.arguments[0].value.includes(arg);\n        });\n\n        if (res)\n          return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.TENTATIVE, manualReview: false }];\n      }\n    }\n  }\n}\n"]}