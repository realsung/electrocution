{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/WebSecurityHTMLCheck.js"],"names":["sourceTypes","severity","confidence","parseWebPreferencesFeaturesString","WebSecurityHTMLCheck","constructor","id","description","type","HTML","shortenedURL","match","cheerioObj","content","loc","webviews","self","each","i","elem","disablewebsecurity","attr","undefined","push","line","substr","startIndex","split","length","column","MEDIUM","CERTAIN","manualReview","wp","features"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;AACA,SAASC,iCAAT,QAAkD,eAAlD;;AAEA,eAAe,MAAMC,oBAAN,CAA2B;AACxCC,gBAAc;AACZ,SAAKC,EAAL,GAAU,yBAAV;AACA,SAAKC,WAAL,GAAoB,+BAApB;AACA,SAAKC,IAAL,GAAYR,YAAYS,IAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,UAAN,EAAkBC,OAAlB,EAA2B;AACzB,UAAMC,MAAM,EAAZ;AACA,UAAMC,WAAWH,WAAW,SAAX,CAAjB;AACA,UAAMI,OAAO,IAAb;AACAD,aAASE,IAAT,CAAc,UAAUC,CAAV,EAAaC,IAAb,EAAmB;AAC/B,YAAMC,qBAAqBR,WAAW,IAAX,EAAiBS,IAAjB,CAAsB,oBAAtB,CAA3B;AACA,UAAID,uBAAuBE,SAA3B,EAAsC;AACpCR,YAAIS,IAAJ,CAAS,EAAEC,MAAMX,QAAQY,MAAR,CAAe,CAAf,EAAkBN,KAAKO,UAAvB,EAAmCC,KAAnC,CAAyC,IAAzC,EAA+CC,MAAvD,EAA+DC,QAAQ,CAAvE,EAA0EvB,IAAIU,KAAKV,EAAnF,EAAuFL,UAAUA,SAAS6B,MAA1G,EAAkH5B,YAAYA,WAAW6B,OAAzI,EAAkJxB,aAAaS,KAAKT,WAApK,EAAiLG,cAAcM,KAAKN,YAApM,EAAkNsB,cAAc,KAAhO,EAAT;AACD;;AAED,UAAIC,KAAKrB,WAAW,IAAX,EAAiBS,IAAjB,CAAsB,gBAAtB,CAAT;AACA,UAAIY,EAAJ,EAAQ;AACN,YAAIC,WAAW/B,kCAAkC8B,EAAlC,CAAf;AACA,YAAIC,SAAS,aAAT,MAA4B,KAAhC,EACEpB,IAAIS,IAAJ,CAAS,EAAEC,MAAMX,QAAQY,MAAR,CAAe,CAAf,EAAkBN,KAAKO,UAAvB,EAAmCC,KAAnC,CAAyC,IAAzC,EAA+CC,MAAvD,EAA+DC,QAAQ,CAAvE,EAA0EvB,IAAIU,KAAKV,EAAnF,EAAuFC,aAAaS,KAAKT,WAAzG,EAAsHG,cAAcM,KAAKN,YAAzI,EAAuJT,UAAUA,SAAS6B,MAA1K,EAAkL5B,YAAYA,WAAW6B,OAAzM,EAAkNC,cAAc,KAAhO,EAAT;AACH;AAEF,KAbD;AAcA,WAAOlB,GAAP;AACD;AA3BuC","file":"WebSecurityHTMLCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\nimport { parseWebPreferencesFeaturesString } from '../../../util';\n\nexport default class WebSecurityHTMLCheck {\n  constructor() {\n    this.id = 'WEB_SECURITY_HTML_CHECK';\n    this.description = `Do not use disablewebsecurity`;\n    this.type = sourceTypes.HTML;\n    this.shortenedURL = \"https://git.io/JeuMr\";\n  }\n\n  match(cheerioObj, content) {\n    const loc = [];\n    const webviews = cheerioObj('webview');\n    const self = this;\n    webviews.each(function (i, elem) {\n      const disablewebsecurity = cheerioObj(this).attr('disablewebsecurity');\n      if (disablewebsecurity !== undefined) {\n        loc.push({ line: content.substr(0, elem.startIndex).split('\\n').length, column: 0, id: self.id, severity: severity.MEDIUM, confidence: confidence.CERTAIN, description: self.description, shortenedURL: self.shortenedURL, manualReview: false });\n      }\n\n      let wp = cheerioObj(this).attr('webpreferences');\n      if (wp) {\n        let features = parseWebPreferencesFeaturesString(wp);\n        if (features['webSecurity'] === false)\n          loc.push({ line: content.substr(0, elem.startIndex).split('\\n').length, column: 0, id: self.id, description: self.description, shortenedURL: self.shortenedURL, severity: severity.MEDIUM, confidence: confidence.CERTAIN, manualReview: false });\n      }\n\n    });\n    return loc;\n  }\n}\n"]}