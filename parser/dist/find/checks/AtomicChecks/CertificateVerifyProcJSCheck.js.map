{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/CertificateVerifyProcJSCheck.js"],"names":["sourceTypes","severity","confidence","CertificateVerifyProcJSCheck","constructor","id","description","type","JAVASCRIPT","shortenedURL","match","astNode","callee","property","name","line","loc","start","column","MEDIUM","TENTATIVE","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,4BAAN,CAAmC;AAChDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,kCAAV;AACA,SAAKC,WAAL,GAAoB,qHAApB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,OAAN,EAAc;AACZ,QAAIA,QAAQJ,IAAR,KAAiB,gBAArB,EACE,OAAO,IAAP;;AAEF,QAAII,QAAQC,MAAR,CAAeC,QAAf,IAA2BF,QAAQC,MAAR,CAAeC,QAAf,CAAwBC,IAAxB,KAAiC,0BAAhE,EAA4F;AAC1F,YAAMR,cAAc,6EAApB;AACA,aAAO,CAAC,EAAES,MAAMJ,QAAQK,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQP,QAAQK,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkEb,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAASkB,MAAlK,EAA0KjB,YAAYA,WAAWkB,SAAjM,EAA4MC,cAAc,IAA1N,EAAD,CAAP;AACD;;AAED,QAAIV,QAAQC,MAAR,CAAeC,QAAf,IAA2BF,QAAQC,MAAR,CAAeC,QAAf,CAAwBC,IAAxB,KAAiC,mBAAhE,EAAqF;AACnF,YAAMR,cAAc,6EAApB;AACA,aAAO,CAAC,EAAES,MAAMJ,QAAQK,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQP,QAAQK,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkEb,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAASkB,MAAlK,EAA0KjB,YAAYA,WAAWkB,SAAjM,EAA4MC,cAAc,IAA1N,EAAD,CAAP;AACD;AACF;AArB+C","file":"CertificateVerifyProcJSCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class CertificateVerifyProcJSCheck {\n  constructor() {\n    this.id = 'CERTIFICATE_VERIFY_PROC_JS_CHECK';\n    this.description = `Do not allow insecure connections, by explicitly opting-out from TLS validation or importing untrusted certificates`;\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = \"https://git.io/Jeu1A\";\n  }\n\n  match(astNode){\n    if (astNode.type !== 'CallExpression')\n      return null;\n\n    if (astNode.callee.property && astNode.callee.property.name === \"setCertificateVerifyProc\") {\n      const description = 'Verify that the application does not explicitly opt-out from TLS validation';\n      return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.TENTATIVE, manualReview: true }];\n    }\n\n    if (astNode.callee.property && astNode.callee.property.name === \"importCertificate\") {\n      const description = 'Verify custom TLS certificates imported into the platform certificate store';\n      return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.TENTATIVE, manualReview: true }];\n    }\n  }\n}\n"]}