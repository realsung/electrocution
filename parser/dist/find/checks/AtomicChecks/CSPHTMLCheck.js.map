{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/CSPHTMLCheck.js"],"names":["sourceTypes","severity","confidence","CSPHTMLCheck","constructor","id","description","type","HTML","shortenedURL","match","cheerioObj","content","loc","metaTags","self","each","i","elem","httpEquiv","attr","cspContent","toLowerCase","push","line","substr","startIndex","split","length","column","INFORMATIONAL","TENTATIVE","properties","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,YAAN,CAAmB;AAChCC,gBAAc;AACZ,SAAKC,EAAL,GAAU,gBAAV;AACA,SAAKC,WAAL,GAAoB,6CAApB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,IAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,UAAN,EAAkBC,OAAlB,EAA2B;AACzB,UAAMC,MAAM,EAAZ;AACA,UAAMC,WAAWH,WAAW,MAAX,CAAjB;AACA,UAAMI,OAAO,IAAb;AACAD,aAASE,IAAT,CAAc,UAAUC,CAAV,EAAaC,IAAb,EAAmB;AAC/B,YAAMC,YAAYR,WAAW,IAAX,EAAiBS,IAAjB,CAAsB,YAAtB,CAAlB;AACA,YAAMC,aAAaV,WAAW,IAAX,EAAiBS,IAAjB,CAAsB,SAAtB,CAAnB;AACA,UAAID,aAAaA,UAAUG,WAAV,OAA4B,0BAA0BA,WAA1B,EAA7C,EAAsF;AACpFT,YAAIU,IAAJ,CAAS,EAAEC,MAAMZ,QAAQa,MAAR,CAAe,CAAf,EAAkBP,KAAKQ,UAAvB,EAAmCC,KAAnC,CAAyC,IAAzC,EAA+CC,MAAvD,EAA+DC,QAAQ,CAAvE,EAA0ExB,IAAIU,KAAKV,EAAnF,EAAuFC,aAAaS,KAAKT,WAAzG,EAAsHG,cAAcM,KAAKN,YAAzI,EAAuJR,UAAUA,SAAS6B,aAA1K,EAAyL5B,YAAYA,WAAW6B,SAAhN,EAA2NC,YAAY,EAAE,aAAaX,UAAf,EAAvO,EAAoQY,cAAc,IAAlR,EAAT;AACD;AACF,KAND;AAOA,WAAOpB,GAAP;AACD;AApB+B","file":"CSPHTMLCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class CSPHTMLCheck {\n  constructor() {\n    this.id = 'CSP_HTML_CHECK';\n    this.description = `A CSP is set for this page using a meta tag`;\n    this.type = sourceTypes.HTML;\n    this.shortenedURL = \"https://git.io/JeuMe\";\n  }\n\n  match(cheerioObj, content) {\n    const loc = [];\n    const metaTags = cheerioObj('meta');\n    const self = this;\n    metaTags.each(function (i, elem) {  \n      const httpEquiv = cheerioObj(this).attr('http-equiv');\n      const cspContent = cheerioObj(this).attr('content');\n      if (httpEquiv && httpEquiv.toLowerCase() === \"Content-Security-Policy\".toLowerCase()) {\n        loc.push({ line: content.substr(0, elem.startIndex).split('\\n').length, column: 0, id: self.id, description: self.description, shortenedURL: self.shortenedURL, severity: severity.INFORMATIONAL, confidence: confidence.TENTATIVE, properties: { \"CSPstring\": cspContent }, manualReview: true });\n      }\n    });\n    return loc;\n  }\n}\n"]}