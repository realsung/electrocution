{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/SecurityWarningsDisabledJSONCheck.js"],"names":["linenumber","severity","confidence","sourceTypes","SecurityWarningsDisabledJSONCheck","constructor","id","description","type","JSON","shortenedURL","dangerousFlag","match","content","npmScripts","json","scripts","undefined","npmConfig","config","location","Object","keys","length","script","hasOwnProperty","res","stringify","includes","ln","text","push","line","column","INFORMATIONAL","CERTAIN","manualReview"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,YAAvB;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;AACA,SAASC,WAAT,QAA4B,uBAA5B;;AAEA,eAAe,MAAMC,iCAAN,CAAwC;AACrDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,uCAAV;AACA,SAAKC,WAAL,GAAoB,yEAApB;AACA,SAAKC,IAAL,GAAYL,YAAYM,IAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACA,SAAKC,aAAL,GAAqB,oCAArB;AACD;;AAED,QAAMC,KAAN,CAAYC,OAAZ,EAAoB;AAClB,UAAMC,aAAaD,QAAQE,IAAR,CAAaC,OAAb,GAAuBH,QAAQE,IAAR,CAAaC,OAApC,GAA8CC,SAAjE,CADkB,CAC0D;AAC5E,UAAMC,YAAYL,QAAQE,IAAR,CAAaI,MAAb,GAAsBN,QAAQE,IAAR,CAAaI,MAAnC,GAA4CF,SAA9D,CAFkB,CAEuD;;AAEzE,QAAIG,WAAW,EAAf;;AAEA;AACA,QAAIN,cAAcO,OAAOC,IAAP,CAAYR,UAAZ,EAAwBS,MAAxB,GAAiC,CAAnD,EAAsD;;AAEpD,WAAK,IAAIC,MAAT,IAAmBV,UAAnB,EAA+B;AAC7B,YAAIA,WAAWW,cAAX,CAA0BD,MAA1B,CAAJ,EAAuC;;AAErC,cAAIE,MAAMjB,KAAKkB,SAAL,CAAeb,WAAWU,MAAX,CAAf,EAAmCI,QAAnC,CAA4C,KAAKjB,aAAjD,CAAV;;AAEA,cAAIe,GAAJ,EAAS;AACP,gBAAIG,KAAK7B,WAAWa,QAAQiB,IAAnB,EAAyBhB,WAAWU,MAAX,CAAzB,CAAT;AACAJ,qBAASW,IAAT,CAAc,EAAEC,MAAMH,GAAG,CAAH,EAAMG,IAAd,EAAoBC,QAAQ,CAA5B,EAA+B3B,IAAI,KAAKA,EAAxC,EAA4CC,aAAa,KAAKA,WAA9D,EAA2EG,cAAc,KAAKA,YAA9F,EAA4GT,UAAUA,SAASiC,aAA/H,EAA8IhC,YAAYA,WAAWiC,OAArK,EAA8KC,cAAc,KAA5L,EAAd;AACD;AAEF;AACF;AACF;;AAED;AACA,QAAIlB,aAAaG,OAAOC,IAAP,CAAYJ,SAAZ,EAAuBK,MAAvB,GAAgC,CAAjD,EAAoD;AAClD,WAAK,IAAIJ,MAAT,IAAmBD,SAAnB,EAA8B;AAC5B,YAAIA,UAAUO,cAAV,CAAyBN,MAAzB,CAAJ,EAAsC;;AAEpC,cAAIO,MAAMjB,KAAKkB,SAAL,CAAeT,UAAUC,MAAV,CAAf,EAAkCS,QAAlC,CAA2C,KAAKjB,aAAhD,CAAV;;AAEA,cAAIe,GAAJ,EAAS;AACP,gBAAIG,KAAK7B,WAAWa,QAAQiB,IAAnB,EAAyBZ,UAAUC,MAAV,CAAzB,CAAT;AACAC,qBAASW,IAAT,CAAc,EAAEC,MAAMH,GAAG,CAAH,EAAMG,IAAd,EAAoBC,QAAQ,CAA5B,EAA+B3B,IAAI,KAAKA,EAAxC,EAA4CC,aAAa,KAAKA,WAA9D,EAA2EG,cAAc,KAAKA,YAA9F,EAA4GT,UAAUA,SAASiC,aAA/H,EAA8IhC,YAAYA,WAAWiC,OAArK,EAA8KC,cAAc,KAA5L,EAAd;AACD;AAEF;AACF;AAEF;AACD,WAAOhB,QAAP;AACD;AAjDoD","file":"SecurityWarningsDisabledJSONCheck.js","sourcesContent":["import linenumber from 'linenumber';\nimport { severity, confidence } from '../../attributes';\nimport { sourceTypes } from '../../../parser/types';\n\nexport default class SecurityWarningsDisabledJSONCheck {\n  constructor() {\n    this.id = 'SECURITY_WARNINGS_DISABLED_JSON_CHECK';\n    this.description = `Warns about flags disabling security warnings in the package.json file.`;\n    this.type = sourceTypes.JSON;\n    this.shortenedURL = \"https://git.io/JeuMw\";\n    this.dangerousFlag = \"ELECTRON_DISABLE_SECURITY_WARNINGS\";\n  }\n\n  async match(content){\n    const npmScripts = content.json.scripts ? content.json.scripts : undefined; //https://docs.npmjs.com/misc/scripts\n    const npmConfig = content.json.config ? content.json.config : undefined; //https://docs.npmjs.com/misc/scripts#special-packagejson-config-object\n\n    let location = [];\n\n    // We look for \"scripts\" key-values\n    if (npmScripts && Object.keys(npmScripts).length > 0) {\n\n      for (var script in npmScripts) {\n        if (npmScripts.hasOwnProperty(script)) {\n\n          var res = JSON.stringify(npmScripts[script]).includes(this.dangerousFlag);\n\n          if (res) {\n            let ln = linenumber(content.text, npmScripts[script]);\n            location.push({ line: ln[0].line, column: 0, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.INFORMATIONAL, confidence: confidence.CERTAIN, manualReview: false });\n          }\n\n        }\n      }\n    }\n\n    // We look for \"config\" key-values\n    if (npmConfig && Object.keys(npmConfig).length > 0) {\n      for (var config in npmConfig) {\n        if (npmConfig.hasOwnProperty(config)) {\n\n          var res = JSON.stringify(npmConfig[config]).includes(this.dangerousFlag);\n\n          if (res) {\n            let ln = linenumber(content.text, npmConfig[config]);\n            location.push({ line: ln[0].line, column: 0, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.INFORMATIONAL, confidence: confidence.CERTAIN, manualReview: false });\n          }\n\n        }\n      }\n\n    }\n    return location;\n  }\n}"]}