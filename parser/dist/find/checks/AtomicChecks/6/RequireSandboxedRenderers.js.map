{"version":3,"sources":["../../../../../src/find/checks/AtomicChecks/6/RequireSandboxedRenderers.js"],"names":["sourceTypes","severity","confidence","DEPRECATED_REQUIRES","RequireSandboxedRenderers","constructor","id","description","type","JAVASCRIPT","shortenedURL","match","astNode","astHelper","scope","callee","name","arguments","StringLiteral","indexOf","value","line","loc","start","column","MEDIUM","TENTATIVE","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,0BAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,qBAArC;;AAEA,MAAMC,sBAAsB,CAAE,eAAF,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,MAA/B,CAA5B;;AAEA,eAAe,MAAMC,yBAAN,CAAgC;AAC7CC,gBAAc;AACZ,SAAKC,EAAL,GAAU,yCAAV;AACA,SAAKC,WAAL,GAAmB,sEAAnB;AACA,SAAKC,IAAL,GAAYR,YAAYS,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,OAAN,EAAeC,SAAf,EAA0BC,KAA1B,EAAgC;AAC9B,QAAIF,QAAQJ,IAAR,KAAiB,gBAArB,EAAuC,OAAO,IAAP;AACvC,QAAI,CAACI,QAAQG,MAAT,IAAmBH,QAAQG,MAAR,CAAeC,IAAf,KAAwB,SAA/C,EAA0D,OAAO,IAAP;AAC1D,QAAI,CAACJ,QAAQK,SAAT,IAAsBL,QAAQK,SAAR,CAAkB,CAAlB,EAAqBT,IAArB,KAA8BK,UAAUK,aAAlE,EAAiF,OAAO,IAAP;AACjF,QAAIf,oBAAoBgB,OAApB,CAA4BP,QAAQK,SAAR,CAAkB,CAAlB,EAAqBG,KAAjD,MAA4D,CAAC,CAAjE,EAAoE,OAAO,IAAP;AACpE,WAAO,CAAC,EAAEC,MAAMT,QAAQU,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQZ,QAAQU,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkElB,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IT,UAAUA,SAASwB,MAAlK,EAA0KvB,YAAYA,WAAWwB,SAAjM,EAA4MC,cAAc,IAA1N,EAAD,CAAP;AACD;AAd4C","file":"RequireSandboxedRenderers.js","sourcesContent":["import { sourceTypes } from '../../../../parser/types';\nimport { severity, confidence } from '../../../attributes';\n\nconst DEPRECATED_REQUIRES = [ 'child_process', 'fs', 'os', 'path' ]\n\nexport default class RequireSandboxedRenderers {\n  constructor() {\n    this.id = 'REQUIRE_SANDBOXED_RENDERERS_DEPRECATION';\n    this.description = '(ELECTRON 6) Certain requires in sandboxed renderers are deprecated.';\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = 'https://git.io/JvalR';\n  }\n\n  match(astNode, astHelper, scope){\n    if (astNode.type !== 'CallExpression') return null;\n    if (!astNode.callee || astNode.callee.name !== 'require') return null;\n    if (!astNode.arguments || astNode.arguments[0].type !== astHelper.StringLiteral) return null;\n    if (DEPRECATED_REQUIRES.indexOf(astNode.arguments[0].value) === -1) return null;\n    return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.TENTATIVE, manualReview: true }];\n  }\n}"]}