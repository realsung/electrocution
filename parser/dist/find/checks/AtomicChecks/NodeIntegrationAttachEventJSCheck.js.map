{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/NodeIntegrationAttachEventJSCheck.js"],"names":["sourceTypes","severity","confidence","NodeIntegrationAttachEventJSCheck","constructor","id","description","type","JAVASCRIPT","shortenedURL","match","astNode","astHelper","callee","property","name","arguments","value","loc","length","found_nodes","findNodeByType","node","left","object","right","push","line","start","column","HIGH","FIRM","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,iCAAN,CAAwC;AACrDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,wCAAV;AACA,SAAKC,WAAL,GAAmB,+CAAnB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,OAAN,EAAeC,SAAf,EAAyB;AACvB,QAAI,EAAGD,QAAQJ,IAAR,KAAiB,gBAAlB,IACEI,QAAQE,MAAR,CAAeC,QADjB,IAEEH,QAAQE,MAAR,CAAeC,QAAf,CAAwBC,IAAxB,KAAiC,IAFnC,IAGEJ,QAAQK,SAAR,CAAkB,CAAlB,CAHF,IAIEL,QAAQK,SAAR,CAAkB,CAAlB,EAAqBC,KAArB,KAA+B,qBAJnC,CAAJ,EAIgE;AAC9D,aAAO,IAAP;AACD;;AAED,QAAIC,MAAM,EAAV;AACA,QAAIP,QAAQK,SAAR,CAAkBG,MAAlB,GAA2B,CAA/B,EAAkC;AAChC,YAAMC,cAAcR,UAAUS,cAAV,CAAyBV,QAAQK,SAAR,CAAkB,CAAlB,CAAzB,EAA+C,sBAA/C,EAAuE,CAAvE,EAA0E,IAA1E,EAClBM,QAAQA,KAAKC,IAAL,CAAUhB,IAAV,KAAmB,kBAAnB,IACGe,KAAKC,IAAL,CAAUC,MAAV,CAAiBT,IAAjB,KAA0B,gBAD7B,IAEGO,KAAKC,IAAL,CAAUT,QAAV,CAAmBC,IAAnB,KAA4B,iBAF/B,IAGGO,KAAKG,KAAL,CAAWR,KAAX,KAAqB,IAJd,CAApB;AAKA,UAAIG,YAAYD,MAAZ,GAAqB,CAAzB,EAA4B;AAC1BD,YAAIQ,IAAJ,CAAS,EAAEC,MAAMP,YAAY,CAAZ,EAAeF,GAAf,CAAmBU,KAAnB,CAAyBD,IAAjC,EAAuCE,QAAQT,YAAY,CAAZ,EAAeF,GAAf,CAAmBU,KAAnB,CAAyBC,MAAxE,EAAgFxB,IAAI,KAAKA,EAAzF,EAA6FC,aAAa,KAAKA,WAA/G,EAA4HG,cAAc,KAAKA,YAA/I,EAA6JR,UAAUA,SAAS6B,IAAhL,EAAsL5B,YAAYA,WAAW6B,IAA7M,EAAmNC,cAAc,KAAjO,EAAT;AACD;AACF;;AAED,WAAOd,GAAP;AACD;AA9BoD","file":"NodeIntegrationAttachEventJSCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class NodeIntegrationAttachEventJSCheck {\n  constructor() {\n    this.id = 'NODE_INTEGRATION_ATTACH_EVENT_JS_CHECK';\n    this.description = 'Disable nodeIntegration for untrusted origins';\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = \"https://git.io/JeuMZ\";\n  }\n\n  match(astNode, astHelper){\n    if (!((astNode.type === 'CallExpression')\n        && (astNode.callee.property)\n        && (astNode.callee.property.name === 'on')\n        && (astNode.arguments[0])\n        && (astNode.arguments[0].value === 'will-attach-webview'))) {\n      return null;\n    }\n\n    let loc = [];\n    if (astNode.arguments.length > 1) {\n      const found_nodes = astHelper.findNodeByType(astNode.arguments[1], 'AssignmentExpression', 0, true,\n        node => node.left.type === 'MemberExpression'\n                && node.left.object.name === 'webPreferences'\n                && node.left.property.name === 'nodeIntegration'\n                && node.right.value === true);\n      if (found_nodes.length > 0) {\n        loc.push({ line: found_nodes[0].loc.start.line, column: found_nodes[0].loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.HIGH, confidence: confidence.FIRM, manualReview: false });\n      }\n    }\n\n    return loc;\n  }\n}\n"]}