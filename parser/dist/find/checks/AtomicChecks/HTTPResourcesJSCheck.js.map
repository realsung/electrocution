{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/HTTPResourcesJSCheck.js"],"names":["sourceTypes","severity","confidence","HTTPResourcesJavascriptCheck","constructor","id","description","type","JAVASCRIPT","shortenedURL","match","astNode","astHelper","callee","property","name","arguments","StringLiteral","value","trim","toUpperCase","startsWith","undefined","quasis","cooked","line","loc","start","column","MEDIUM","CERTAIN","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,4BAAN,CAAmC;AAChDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,yBAAV;AACA,SAAKC,WAAL,GAAoB,wCAApB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,OAAN,EAAeC,SAAf,EAAyB;AACvB,QAAID,QAAQJ,IAAR,KAAiB,gBAArB,EAAuC,OAAO,IAAP;AACvC,QAAI,EAAEI,QAAQE,MAAR,CAAeC,QAAf,IAA2BH,QAAQE,MAAR,CAAeC,QAAf,CAAwBC,IAAxB,KAAiC,SAA9D,CAAJ,EAA8E,OAAO,IAAP;;AAE9E,YAAQJ,QAAQK,SAAR,CAAkB,CAAlB,EAAqBT,IAA7B;AACE,WAAKK,UAAUK,aAAf;AACE,YAAI,CAACN,QAAQK,SAAR,CAAkB,CAAlB,EAAqBE,KAArB,CAA2BC,IAA3B,GAAkCC,WAAlC,GAAgDC,UAAhD,CAA2D,SAA3D,CAAL,EACE,OAAOC,SAAP;AACF;AACF,WAAK,iBAAL;AACE,YAAIX,QAAQK,SAAR,CAAkB,CAAlB,EAAqBT,IAArB,KAA8B,iBAA9B,IACAI,QAAQK,SAAR,CAAkB,CAAlB,EAAqBO,MAArB,CAA4B,CAA5B,EAA+BhB,IAA/B,KAAwC,iBADxC,IAEA,CAACI,QAAQK,SAAR,CAAkB,CAAlB,EAAqBO,MAArB,CAA4B,CAA5B,EAA+BL,KAA/B,CAAqCM,MAArC,CAA4CL,IAA5C,GAAmDC,WAAnD,GAAiEC,UAAjE,CAA4E,SAA5E,CAFL,EAGE,OAAOC,SAAP;AACF;AACF;AACE,eAAOA,SAAP;AAZJ;;AAeA,WAAO,CAAC,EAAEG,MAAMd,QAAQe,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQjB,QAAQe,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkEvB,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAAS4B,MAAlK,EAA0K3B,YAAYA,WAAW4B,OAAjM,EAA0MC,cAAc,KAAxN,EAAD,CAAP;AACD;AA5B+C","file":"HTTPResourcesJSCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class HTTPResourcesJavascriptCheck {\n  constructor() {\n    this.id = 'HTTP_RESOURCES_JS_CHECK';\n    this.description = `Do not allow insecure HTTP connections`;\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = \"https://git.io/JeuML\";\n  }\n\n  match(astNode, astHelper){\n    if (astNode.type !== 'CallExpression') return null;\n    if (!(astNode.callee.property && astNode.callee.property.name === \"loadURL\")) return null;\n\n    switch (astNode.arguments[0].type) {\n      case astHelper.StringLiteral:\n        if (!astNode.arguments[0].value.trim().toUpperCase().startsWith(\"HTTP://\"))\n          return undefined;\n        break;\n      case \"TemplateLiteral\":\n        if (astNode.arguments[0].type !== \"TemplateLiteral\" ||\n            astNode.arguments[0].quasis[0].type !== \"TemplateElement\" ||\n            !astNode.arguments[0].quasis[0].value.cooked.trim().toUpperCase().startsWith(\"HTTP://\"))\n          return undefined;\n        break;\n      default:\n        return undefined;\n    }\n\n    return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.CERTAIN, manualReview: false }];\n  }\n}\n"]}