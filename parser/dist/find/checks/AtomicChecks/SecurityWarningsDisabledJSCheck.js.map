{"version":3,"sources":["../../../../src/find/checks/AtomicChecks/SecurityWarningsDisabledJSCheck.js"],"names":["sourceTypes","severity","confidence","SecurityWarningsDisabledJSCheck","constructor","id","description","type","JAVASCRIPT","shortenedURL","match","astNode","left","object","property","name","value","toString","toUpperCase","right","line","loc","start","column","INFORMATIONAL","CERTAIN","manualReview"],"mappings":"AAAA,SAASA,WAAT,QAA4B,uBAA5B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,+BAAN,CAAsC;AACnDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,qCAAV;AACA,SAAKC,WAAL,GAAmB,+DAAnB;AACA,SAAKC,IAAL,GAAYP,YAAYQ,UAAxB;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAEDC,QAAMC,OAAN,EAAc;AACZ,QAAIA,QAAQJ,IAAR,KAAiB,sBAArB,EAA6C,OAAO,IAAP;;AAE7C,QAAII,QAAQC,IAAR,CAAaC,MAAb,IAAuBF,QAAQC,IAAR,CAAaC,MAAb,CAAoBC,QAA/C,EAAyD;AACvD,UAAIH,QAAQC,IAAR,CAAaC,MAAb,CAAoBC,QAApB,CAA6BC,IAA7B,KAAsC,KAAtC,IAA+CJ,QAAQC,IAAR,CAAaC,MAAb,CAAoBC,QAApB,CAA6BC,IAA7B,KAAsC,aAAzF,EAAwG;AACtG,YAAIJ,QAAQC,IAAR,CAAaE,QAAb,IAAyBH,QAAQC,IAAR,CAAaE,QAAb,CAAsBE,KAA/C,IAAwDL,QAAQC,IAAR,CAAaE,QAAb,CAAsBE,KAAtB,CAA4BC,QAA5B,GAAuCC,WAAvC,OAAyD,oCAAjH,IAAyJP,QAAQQ,KAAR,CAAcH,KAA3K,EACE,OAAO,CAAC,EAAEI,MAAMT,QAAQU,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQZ,QAAQU,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkElB,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAASuB,aAAlK,EAAiLtB,YAAYA,WAAWuB,OAAxM,EAAiNC,cAAc,KAA/N,EAAD,CAAP;AACH;AACF;;AAED,QAAIf,QAAQC,IAAR,CAAaE,QAAb,IAAyBH,QAAQC,IAAR,CAAaE,QAAb,CAAsBC,IAA/C,IAAuDJ,QAAQC,IAAR,CAAaE,QAAb,CAAsBC,IAAtB,KAA+B,oCAAtF,IAA8HJ,QAAQQ,KAAR,CAAcH,KAAhJ,EAAuJ;AACrJ,aAAO,CAAC,EAAEI,MAAMT,QAAQU,GAAR,CAAYC,KAAZ,CAAkBF,IAA1B,EAAgCG,QAAQZ,QAAQU,GAAR,CAAYC,KAAZ,CAAkBC,MAA1D,EAAkElB,IAAI,KAAKA,EAA3E,EAA+EC,aAAa,KAAKA,WAAjG,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IR,UAAUA,SAASuB,aAAlK,EAAiLtB,YAAYA,WAAWuB,OAAxM,EAAiNC,cAAc,KAA/N,EAAD,CAAP;AACD,KAFD,MAEO,OAAO,IAAP;AACR;;AArBkD","file":"SecurityWarningsDisabledJSCheck.js","sourcesContent":["import { sourceTypes } from '../../../parser/types';\nimport { severity, confidence } from '../../attributes';\n\nexport default class SecurityWarningsDisabledJSCheck {\n  constructor() {\n    this.id = 'SECURITY_WARNINGS_DISABLED_JS_CHECK';\n    this.description = 'Warns about flags disabling security warnings in the sources.';\n    this.type = sourceTypes.JAVASCRIPT;\n    this.shortenedURL = \"https://git.io/JeuMa\";\n  }\n\n  match(astNode){\n    if (astNode.type !== \"AssignmentExpression\") return null;\n\n    if (astNode.left.object && astNode.left.object.property) {\n      if (astNode.left.object.property.name === \"env\" || astNode.left.object.property.name === \"webContents\") {\n        if (astNode.left.property && astNode.left.property.value && astNode.left.property.value.toString().toUpperCase() === \"ELECTRON_DISABLE_SECURITY_WARNINGS\" && astNode.right.value)\n          return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.INFORMATIONAL, confidence: confidence.CERTAIN, manualReview: false }];\n      }\n    }\n\n    if (astNode.left.property && astNode.left.property.name && astNode.left.property.name === \"ELECTRON_DISABLE_SECURITY_WARNINGS\" && astNode.right.value) {\n      return [{ line: astNode.loc.start.line, column: astNode.loc.start.column, id: this.id, description: this.description, shortenedURL: this.shortenedURL, severity: severity.INFORMATIONAL, confidence: confidence.CERTAIN, manualReview: false }];\n    } else return null;\n  }\n\n}"]}