{"version":3,"sources":["../../../../src/find/checks/GlobalChecks/PermissionRequestHandlerGlobalCheck.js"],"names":["severity","confidence","PermissionRequestHandlerGlobalCheck","constructor","id","description","NONE_FOUND","depends","shortenedURL","perform","issues","length","file","location","line","column","MEDIUM","CERTAIN","manualReview","forEach","e","visibility","globalCheckDisabled"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,mCAAN,CAA0C;;AAEvDC,gBAAc;AACZ,SAAKC,EAAL,GAAU,yCAAV;AACA,SAAKC,WAAL,GAAmB,EAAEC,YAAY,mIAAd,EAAnB;AACA,SAAKC,OAAL,GAAe,CAAC,iCAAD,CAAf;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAED,QAAMC,OAAN,CAAcC,MAAd,EAAsB;;AAEpB,QAAIA,OAAOC,MAAP,KAAkB,CAAtB,EAAyB;AACvB,aAAO,CAAC,EAAEC,MAAM,KAAR,EAAeC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAAzB,EAA+CX,IAAI,KAAKA,EAAxD,EAA4DC,aAAa,KAAKA,WAAL,CAAiBC,UAA1F,EAAsGE,cAAc,KAAKA,YAAzH,EAAuIR,UAAUA,SAASgB,MAA1J,EAAkKf,YAAYA,WAAWgB,OAAzL,EAAkMC,cAAc,KAAhN,EAAD,CAAP;AACD,KAFD,MAEO;AACLR,aAAOS,OAAP,CAAeC,KAAKA,EAAEC,UAAF,CAAaC,mBAAb,GAAmC,IAAvD;AACA,aAAOZ,MAAP;AACD;AACF;AAjBsD","file":"PermissionRequestHandlerGlobalCheck.js","sourcesContent":["import { severity, confidence } from '../../attributes';\n\nexport default class PermissionRequestHandlerGlobalCheck {\n\n  constructor() {\n    this.id = \"PERMISSION_REQUEST_HANDLER_GLOBAL_CHECK\";\n    this.description = { NONE_FOUND: \"Missing PermissionRequestHandler to limit specific permissions (e.g. openExternal) in response to events from particular origins.\"};\n    this.depends = [\"PermissionRequestHandlerJSCheck\"];\n    this.shortenedURL = \"https://git.io/JeuM0\";\n  }\n\n  async perform(issues) {\n\n    if (issues.length === 0) {\n      return [{ file: \"N/A\", location: {line: 0, column: 0}, id: this.id, description: this.description.NONE_FOUND, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.CERTAIN, manualReview: false }];\n    } else {\n      issues.forEach(e => e.visibility.globalCheckDisabled = true)\n      return issues;\n    }\n  }\n}\n"]}