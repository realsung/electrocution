{"version":3,"sources":["../../../../src/find/checks/GlobalChecks/LimitNavigationGlobalCheck.js"],"names":["severity","confidence","LimitNavigationGlobalCheck","constructor","id","description","NONE_FOUND","NEW_WINDOW_MISSING","WILL_NAVIGATE_MISSING","depends","shortenedURL","perform","issues","willNavigateNavigations","filter","e","properties","event","newWindowNavigations","length","file","location","line","column","HIGH","CERTAIN","manualReview","issue","Array","isArray","visibility","excludesGlobal","includes"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,0BAAN,CAAiC;;AAE9CC,gBAAc;AACZ,SAAKC,EAAL,GAAU,+BAAV;AACA,SAAKC,WAAL,GAAmB;AACjBC,kBAAY,yEADK;AAEjBC,0BAAoB,yCAFH;AAGjBC,6BAAuB;AAHN,KAAnB;AAKA,SAAKC,OAAL,GAAe,CAAC,wBAAD,CAAf;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAED,QAAMC,OAAN,CAAcC,MAAd,EAAsB;;AAEpB,QAAIC,0BAA0BD,OAAOE,MAAP,CAAcC,KAAKA,EAAEC,UAAF,CAAaC,KAAb,KAAuB,eAA1C,CAA9B;AACA,QAAIC,uBAAuBN,OAAOE,MAAP,CAAcC,KAAKA,EAAEC,UAAF,CAAaC,KAAb,KAAuB,YAA1C,CAA3B;;AAEA,QAAIL,OAAOO,MAAP,IAAiB,CAArB,EAAwB;AAAE;AACxB,aAAO,CAAC,EAAEC,MAAM,KAAR,EAAeC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAAzB,EAA+CnB,IAAI,KAAKA,EAAxD,EAA4DC,aAAa,KAAKA,WAAL,CAAiBC,UAA1F,EAAsGI,cAAc,KAAKA,YAAzH,EAAuIV,UAAUA,SAASwB,IAA1J,EAAgKvB,YAAYA,WAAWwB,OAAvL,EAAgMC,cAAc,KAA9M,EAAD,CAAP;AACD,KAFD,MAEO,IAAIb,wBAAwBM,MAAxB,GAAiC,CAAjC,IAAsCD,qBAAqBC,MAArB,GAA8B,CAAxE,EAA2E;AAChF;AACA,aAAOP,OAAOE,MAAP,CAAca,SAASC,MAAMC,OAAN,CAAcF,MAAMG,UAAN,CAAiBC,cAA/B,KAAkD,CAACJ,MAAMG,UAAN,CAAiBC,cAAjB,CAAgCC,QAAhC,CAAyC,KAAK5B,EAA9C,CAA1E,CAAP;AACD,KAHM,MAGA,IAAIS,wBAAwBM,MAAxB,IAAkC,CAAtC,EAAyC;AAC9C;AACA,aAAO,CAAC,EAAEC,MAAM,KAAR,EAAeC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAAzB,EAA+CnB,IAAI,KAAKA,EAAxD,EAA4DC,aAAa,KAAKA,WAAL,CAAiBG,qBAA1F,EAAiHE,cAAc,KAAKA,YAApI,EAAkJV,UAAUA,SAASwB,IAArK,EAA2KvB,YAAYA,WAAWwB,OAAlM,EAA2MC,cAAc,KAAzN,EAAD,CAAP;AACD,KAHM,MAGA,IAAIR,qBAAqBC,MAArB,IAA+B,CAAnC,EAAsC;AAC3C;AACA,aAAO,CAAC,EAAEC,MAAM,KAAR,EAAeC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAAzB,EAA+CnB,IAAI,KAAKA,EAAxD,EAA4DC,aAAa,KAAKA,WAAL,CAAiBE,kBAA1F,EAA8GG,cAAc,KAAKA,YAAjI,EAA+IV,UAAUA,SAASwB,IAAlK,EAAwKvB,YAAYA,WAAWwB,OAA/L,EAAwMC,cAAc,KAAtN,EAAD,CAAP;AACD;AACF;AA9B6C","file":"LimitNavigationGlobalCheck.js","sourcesContent":["import { severity, confidence } from '../../attributes';\n\nexport default class LimitNavigationGlobalCheck {\n\n  constructor() {\n    this.id = \"LIMIT_NAVIGATION_GLOBAL_CHECK\";\n    this.description = {\n      NONE_FOUND: \"Missing navigation limits using .on new-window and will-navigate events\",\n      NEW_WINDOW_MISSING: \"Missing .on new-window navigation limit\",\n      WILL_NAVIGATE_MISSING: \"Missing .on will-navigate navigation limit\",\n     };\n    this.depends = [\"LimitNavigationJSCheck\"];\n    this.shortenedURL = \"https://git.io/JeuMs\";\n  }\n\n  async perform(issues) {\n\n    var willNavigateNavigations = issues.filter(e => e.properties.event === 'will-navigate');\n    var newWindowNavigations = issues.filter(e => e.properties.event === 'new-window');\n\n    if (issues.length == 0) { // no navigation events, yikes!\n      return [{ file: \"N/A\", location: {line: 0, column: 0}, id: this.id, description: this.description.NONE_FOUND, shortenedURL: this.shortenedURL, severity: severity.HIGH, confidence: confidence.CERTAIN, manualReview: false }];\n    } else if (willNavigateNavigations.length > 0 && newWindowNavigations.length > 0) {\n      // all good, but mark for review unless the global check is explicitly disabled\n      return issues.filter(issue => Array.isArray(issue.visibility.excludesGlobal) && !issue.visibility.excludesGlobal.includes(this.id));\n    } else if (willNavigateNavigations.length == 0) {\n      // no willnavigate, issue a finding\n      return [{ file: \"N/A\", location: {line: 0, column: 0}, id: this.id, description: this.description.WILL_NAVIGATE_MISSING, shortenedURL: this.shortenedURL, severity: severity.HIGH, confidence: confidence.CERTAIN, manualReview: false }];\n    } else if (newWindowNavigations.length == 0) {\n      // no newwindow, issue a finding\n      return [{ file: \"N/A\", location: {line: 0, column: 0}, id: this.id, description: this.description.NEW_WINDOW_MISSING, shortenedURL: this.shortenedURL, severity: severity.HIGH, confidence: confidence.CERTAIN, manualReview: false }];\n    }\n  }\n}"]}