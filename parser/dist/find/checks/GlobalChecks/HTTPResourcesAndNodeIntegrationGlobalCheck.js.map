{"version":3,"sources":["../../../../src/find/checks/GlobalChecks/HTTPResourcesAndNodeIntegrationGlobalCheck.js"],"names":["severity","confidence","HTTPResourcesAndNodeIntegrationGlobalCheck","constructor","id","description","INSECURE_INTEGRATION","depends","shortenedURL","perform","issues","httpResourcesIssues","filter","e","nodeIntegrationIssues","length","push","file","location","line","column","MEDIUM","CERTAIN","manualReview"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,0CAAN,CAAiD;;AAE9DC,gBAAc;AACZ,SAAKC,EAAL,GAAU,mDAAV;AACA,SAAKC,WAAL,GAAmB,EAAEC,sBAAsB,wHAAxB,EAAnB;AACA,SAAKC,OAAL,GAAe,CAAC,8BAAD,EAAgC,wBAAhC,EAAyD,0BAAzD,EAAqF,wBAArF,CAAf;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAED,QAAMC,OAAN,CAAcC,MAAd,EAAsB;AACpB,QAAIC,sBAAsBD,OAAOE,MAAP,CAAcC,KAAKA,EAAET,EAAF,KAAS,yBAAT,IAAsCS,EAAET,EAAF,KAAS,2BAAlE,CAA1B;AACA,QAAIU,wBAAwBJ,OAAOE,MAAP,CAAcC,KAAKA,EAAET,EAAF,KAAS,6BAAT,IAA0CS,EAAET,EAAF,KAAS,2BAAtE,CAA5B;;AAEA,QAAIO,oBAAoBI,MAApB,GAA6B,CAA7B,IAAkCD,sBAAsBC,MAAtB,GAA+B,CAArE,EACEL,OAAOM,IAAP,CAAY,EAAEC,MAAM,KAAR,EAAeC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAAzB,EAA+ChB,IAAI,KAAKA,EAAxD,EAA4DC,aAAa,KAAKA,WAAL,CAAiBC,oBAA1F,EAAgHE,cAAc,KAAKA,YAAnI,EAAiJR,UAAUA,SAASqB,MAApK,EAA4KpB,YAAYA,WAAWqB,OAAnM,EAA4MC,cAAc,IAA1N,EAAZ;;AAEF,WAAOb,MAAP;AAED;AAlB6D","file":"HTTPResourcesAndNodeIntegrationGlobalCheck.js","sourcesContent":["import { severity, confidence } from '../../attributes';\n\nexport default class HTTPResourcesAndNodeIntegrationGlobalCheck {\n\n  constructor() {\n    this.id = \"HTTP_RESOURCES_WITH_NODE_INTEGRATION_GLOBAL_CHECK\";\n    this.description = { INSECURE_INTEGRATION: \"The nodeIntegration flag is enabled for the application, but some resources are loaded over an unencrypted connection.\"};\n    this.depends = [\"HTTPResourcesJavascriptCheck\",\"HTTPResourcesHTMLCheck\",\"NodeIntegrationHTMLCheck\", \"NodeIntegrationJSCheck\"];\n    this.shortenedURL = \"https://git.io/JeuM6\";\n  }\n\n  async perform(issues) {\n    var httpResourcesIssues = issues.filter(e => e.id === 'HTTP_RESOURCES_JS_CHECK' || e.id === \"HTTP_RESOURCES_HTML_CHECK\");\n    var nodeIntegrationIssues = issues.filter(e => e.id === 'NODE_INTEGRATION_HTML_CHECK' || e.id === 'NODE_INTEGRATION_JS_CHECK');\n\n    if (httpResourcesIssues.length > 0 && nodeIntegrationIssues.length > 0)\n      issues.push({ file: \"N/A\", location: {line: 0, column: 0}, id: this.id, description: this.description.INSECURE_INTEGRATION, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.CERTAIN, manualReview: true });\n\n    return issues;\n\n  }\n}\n"]}