{"version":3,"sources":["../../../../src/find/checks/GlobalChecks/AffinityGlobalCheck.js"],"names":["severity","confidence","AffinityGlobalCheck","constructor","id","description","AFFINITY_FOUND","depends","shortenedURL","perform","issues","affinityIssues","filter","e","otherIssues","length","uniq","map","issue","count","value","properties","AffinityString","reduce","a","b","duplicates","Object","keys","push","file","location","line","column","MEDIUM","CERTAIN","manualReview"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;;AAEA,eAAe,MAAMC,mBAAN,CAA0B;;AAEvCC,gBAAc;AACZ,SAAKC,EAAL,GAAU,uBAAV;AACA,SAAKC,WAAL,GAAmB,EAAEC,gBAAgB,4IAAlB,EAAnB;AACA,SAAKC,OAAL,GAAe,CAAC,iBAAD,EAAoB,mBAApB,CAAf;AACA,SAAKC,YAAL,GAAoB,sBAApB;AACD;;AAED,QAAMC,OAAN,CAAcC,MAAd,EAAsB;AACpB,QAAIC,iBAAiBD,OAAOE,MAAP,CAAcC,KAAKA,EAAET,EAAF,KAAS,mBAAT,IAAgCS,EAAET,EAAF,KAAS,qBAA5D,CAArB;AACA,QAAIU,cAAcJ,OAAOE,MAAP,CAAcC,KAAKA,EAAET,EAAF,KAAS,mBAAT,IAAgCS,EAAET,EAAF,KAAS,qBAA5D,CAAlB;AACA,QAAIO,eAAeI,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,YAAMC,OAAOL,eAAeM,GAAf,CAAoBC,KAAD,IAAW;AACzC,eAAO,EAACC,OAAO,CAAR,EAAWC,OAAOF,MAAMG,UAAN,CAAiBC,cAAnC,EAAP;AACD,OAFY,EAEVC,MAFU,CAEH,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAClBD,UAAEC,EAAEL,KAAJ,IAAa,CAACI,EAAEC,EAAEL,KAAJ,KAAc,CAAf,IAAoBK,EAAEN,KAAnC;AACA,eAAOK,CAAP;AACD,OALY,EAKV,EALU,CAAb;AAMA,UAAIE,aAAaC,OAAOC,IAAP,CAAYZ,IAAZ,EAAkBJ,MAAlB,CAA0BY,CAAD,IAAOR,KAAKQ,CAAL,IAAU,CAA1C,CAAjB;;AAEA,UAAIE,WAAWX,MAAX,GAAoB,CAAxB,EAA2B;AACzBD,oBAAYe,IAAZ,CAAiB,EAAEC,MAAMnB,eAAe,CAAf,EAAkBmB,IAA1B,EAAgCC,UAAU,EAACC,MAAM,CAAP,EAAUC,QAAQ,CAAlB,EAA1C,EAAgE7B,IAAI,KAAKA,EAAzE,EAA6EC,aAAa,KAAKA,WAAL,CAAiBC,cAA3G,EAA2HE,cAAc,KAAKA,YAA9I,EAA4JR,UAAUA,SAASkC,MAA/K,EAAuLjC,YAAYA,WAAWkC,OAA9M,EAAuNC,cAAc,IAArO,EAAjB;AACD;AACF;;AAED,WAAOtB,WAAP;AACD;AA3BsC","file":"AffinityGlobalCheck.js","sourcesContent":["import { severity, confidence } from '../../attributes';\n\nexport default class AffinityGlobalCheck {\n\n  constructor() {\n    this.id = \"AFFINITY_GLOBAL_CHECK\";\n    this.description = { AFFINITY_FOUND: \"Two or more rendereres are running with the same affinity property. Manual review is required since we don't check for the webPreferences.\"};\n    this.depends = [\"AffinityJSCheck\", \"AffinityHTMLCheck\"];\n    this.shortenedURL = \"https://git.io/Jeu1z\";\n  }\n\n  async perform(issues) {\n    var affinityIssues = issues.filter(e => e.id === 'AFFINITY_JS_CHECK' || e.id === 'AFFINITY_HTML_CHECK');\n    var otherIssues = issues.filter(e => e.id !== 'AFFINITY_JS_CHECK' && e.id !== 'AFFINITY_HTML_CHECK');\n    if (affinityIssues.length > 0) {\n      const uniq = affinityIssues.map((issue) => {\n        return {count: 1, value: issue.properties.AffinityString};\n      }).reduce((a, b) => {\n        a[b.value] = (a[b.value] || 0) + b.count;\n        return a;\n      }, {});\n      var duplicates = Object.keys(uniq).filter((a) => uniq[a] > 1);\n\n      if (duplicates.length > 0) {\n        otherIssues.push({ file: affinityIssues[0].file, location: {line: 0, column: 0}, id: this.id, description: this.description.AFFINITY_FOUND, shortenedURL: this.shortenedURL, severity: severity.MEDIUM, confidence: confidence.CERTAIN, manualReview: true });\n      }\n    }\n\n    return otherIssues;\n  }\n}\n"]}